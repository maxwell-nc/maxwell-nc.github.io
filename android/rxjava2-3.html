<!DOCTYPE html>
<html lang="chinese (simplified)">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="前序   上篇说到RxJava创建操作符，这一节来说说过滤操作符，还记得上节中说到interval操作符如果没有其他限制的话就会无限发送onNext事件，永远也不会调用onComplete事件，如果需要限制的话，可以使用一些过滤操作符进行限制。 filter   先说一个基本的过滤操作符filter，可以自己设定任意的规则来过滤数据，比如过滤出大于等于2的元素：...">
        <meta name="keywords" content="android, reactive-streams, rxjava">
        <link rel="icon" href="https://maxwell-nc.github.io/favicon.ico">

        <title>RxJava 2.x 使用详解(三) 过滤操作符 - Maxwell's Growth Path</title>

        <!-- Stylesheets -->
        <link href="https://maxwell-nc.github.io/theme/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://maxwell-nc.github.io/theme/css/nest.css" rel="stylesheet">
        <link href="https://maxwell-nc.github.io/theme/css/pygment.css" rel="stylesheet">
        <!-- /Stylesheets -->

        <!-- RSS Feeds -->
        <link href="https://maxwell-nc.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Maxwell's Growth Path Full Atom Feed" />
        <link href="https://maxwell-nc.github.io/feeds/android.atom.xml" type="application/atom+xml" rel="alternate" title="Maxwell's Growth Path Categories Atom Feed" />
        <!-- /RSS Feeds -->

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->



    </head>

    <body>

        <!-- Header -->
    <div class="header-container-article gradient">

            <!-- Static navbar -->
            <div class="container">
                <div class="header-nav">
                    <!-- <div class="header-logo">
                        <a class="pull-left" href="https://maxwell-nc.github.io/"><img class="mr20" src="https://maxwell-nc.github.io/logo.svg" alt="logo">Maxwell's Growth Path</a>
                    </div> -->
                    <div class="nav pull-right">
                                <a href="https://maxwell-nc.github.io/">主页</a>
                                <a href="https://maxwell-nc.github.io/categories.html">博文目录</a>
                                <a href="https://maxwell-nc.github.io/tags.html">标签</a>
                                <a href="https://maxwell-nc.github.io/feeds/all.atom.xml">订阅</a>
                    </div>
                </div>
            </div>
            <!-- /Static navbar -->

            <!-- Header -->
    <!-- Header -->
	<script src="https://maxwell-nc.github.io/theme/js/toc.js" type="text/javascript"></script>
	<script type="text/javascript">
	if(window.screen.width >= 768){
		window.onscroll = function(){
			var t = document.documentElement.scrollTop || document.body.scrollTop; 
			var top_div = document.getElementById( "top_div" );
			if( t >= 300 ) {
				top_div.style.display = "block";
			} else {
				top_div.style.display = "none";
			}
		}
	}
	</script>
    <div class="container header-wrapper-article">
        <div class="row">
              <div class="col-lg-12">
					<div class="header-vertical-line"></div>
					<h1 class="header-title-article">RxJava 2.x 使用详解(三) 过滤操作符</h1>
					<p class="header-date-article">
					<!-- 作者 <a href="https://maxwell-nc.github.io/author/maxwell-nc.html">Maxwell-nc</a>, --> 
					2017-06-28&nbsp;&nbsp;|&nbsp;&nbsp;
					<span class="glyphicon glyphicon-folder-open mr5" aria-hidden="true"></span> <a href="https://maxwell-nc.github.io/category/android.html">Android</a>&nbsp;&nbsp;
					<span class="glyphicon glyphicon-tags mr5" aria-hidden="true"></span>
<a href="https://maxwell-nc.github.io/tag/android.html">android</a>, <a href="https://maxwell-nc.github.io/tag/reactive-streams.html">reactive-streams</a>, <a href="https://maxwell-nc.github.io/tag/rxjava.html">rxjava</a></p>
              </div>
        </div>
    </div>
    <!-- /Header -->
            <!-- /Header -->

        </div>
        <!-- /Header -->


        <!-- Content -->
	<div id="top_div" onclick="javascript:window.scrollTo(0,0)"><span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span> 回到顶部</div>
    <div id="contents" class="container content">
		<div id="toc"></div>
        <h2>前序</h2>
<p>&emsp;&emsp;上篇说到RxJava创建操作符，这一节来说说过滤操作符，还记得上节中说到interval操作符如果没有其他限制的话就会无限发送onNext事件，永远也不会调用onComplete事件，如果需要限制的话，可以使用一些过滤操作符进行限制。</p>
<h2>filter</h2>
<p>&emsp;&emsp;先说一个基本的过滤操作符filter，可以自己设定任意的规则来过滤数据，比如过滤出大于等于2的元素：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
        <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="k">new</span> <span class="n">Predicate</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">test</span><span class="o">(</span><span class="n">Integer</span> <span class="n">integer</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
                <span class="c1">//过滤出&gt;=2的数据</span>
                <span class="k">return</span> <span class="n">integer</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">})</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">integer</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">integer</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上面的结果只会输出2和3，因为<code>boolean test(T t)</code>方法返回true则表示元素数据有效，否则则为无效抛弃。</p>
<h2>take</h2>
<p>&emsp;&emsp;如果需要使用类似request(long)的方法来限制发射数据的数量，可以使用take操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">5</span><span class="o">)</span><span class="c1">//只发射5个元素</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">integer</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">integer</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;take操作符可以采用时间过滤，例如过滤出5秒之内发送的数据：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span><span class="c1">//5秒之内的数据（这里输出0,1,2,3）</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">integer</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">integer</span><span class="o">)));</span>
</pre></div>


<h2>takeLast</h2>
<p>&emsp;&emsp;如果要筛选出最后几个元素的话可以使用takeLast操作符，比如选取最后3个元素：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
        <span class="o">.</span><span class="na">takeLast</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">integer</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">integer</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;也可以通过时间来筛选，比如筛选出最后三秒的数据：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">takeLast</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span><span class="c1">//最后三秒发送的数据</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">integer</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">integer</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;另外使用takeLast操作符筛选时间，可以增加delayError参数(不传默认为false)<code>takeLast(3, TimeUnit.SECONDS, true)</code>来延迟筛选过程中接收到的error。</p>
<p>&emsp;&emsp;使用takeLast要特别注意，首先元素数量是可数的，由于takeLast使用的是buffer，所以<strong>过滤后的数据会一次性发送</strong>（而不是按照例如intervalRange设定的方式发送），当然这里可以指定takeLast使用的bufferSize。</p>
<h2>firstElement / lastElement</h2>
<p>&emsp;&emsp;如果需要选取第一个元素(允许为空)，可以使用firstElement操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span>
        <span class="o">.</span><span class="na">firstElement</span><span class="o">()</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;同理，如果要选取最后一个元素(允许为空)，可以使用lastElement操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">)</span>
        <span class="o">.</span><span class="na">lastElement</span><span class="o">()</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<h2>first / last</h2>
<p>&emsp;&emsp;如果要设置一个默认值（当被观察者不发射任何元素的时候）可以使用first操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">empty</span><span class="o">()</span>                                             
        <span class="o">.</span><span class="na">first</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span><span class="c1">//这里的2是默认元素，非第二个元素                          </span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述的代码将会输入“2”这个元素。</p>
<p>&emsp;&emsp;同理如果要设置lastElement为空时发送的元素默认值，可以使用last操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">empty</span><span class="o">()</span>
        <span class="o">.</span><span class="na">last</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span><span class="c1">//这里的3是默认发射元素，并非第三个元素</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述的代码将会输入“3”这个元素。</p>
<h2>firstOrError / lastOrError</h2>
<p>&emsp;&emsp;上述说到的firstElement操作符，如果为空元素的时候不会发生任何异常，如果你需要在空的时候抛出异常，可以使用firstOrError操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">empty</span><span class="o">()</span>
        <span class="o">.</span><span class="na">firstOrError</span><span class="o">()</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码将会抛出异常。</p>
<p>&emsp;&emsp;上述说到的lastElement操作符也是遇到空元素也是不会发生任何的异常，如果你需要在空的时候抛出异常，可以使用lastOrError操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">empty</span><span class="o">()</span>
        <span class="o">.</span><span class="na">lastOrError</span><span class="o">()</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码将会抛出异常。</p>
<h2>elementAt / elementAtOrError</h2>
<p>&emsp;&emsp;如果需要指定发射第几个元素（注意这里的参数为索引值），可以使用elementAt操作符（支持越界）</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span><span class="s">&quot;b&quot;</span><span class="o">,</span><span class="s">&quot;c&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">elementAt</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span><span class="c1">//指定索引为2的元素，如果不存在则直接完成</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;如果需要设置越界后发送的默认元素，可以添加额外默认值参数：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span><span class="s">&quot;b&quot;</span><span class="o">,</span><span class="s">&quot;c&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">elementAt</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="s">&quot;d&quot;</span><span class="o">)</span><span class="c1">//指定索引为4的元素，如果不存在则发射“d”</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;如果希望越界后抛出异常，可以使用elementAtOrError操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span><span class="s">&quot;b&quot;</span><span class="o">,</span><span class="s">&quot;c&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">elementAtOrError</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span><span class="c1">//指定索引值为3的元素，如果不存在则抛出异常</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<h2>ofType</h2>
<p>&emsp;&emsp;假设你需要筛选特定类型的数据，可以采用ofType操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="s">&quot;b&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">ofType</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">integer</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">integer</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码只会输出1、3，其他元素被抛弃。</p>
<h2>skip / skipLast</h2>
<p>&emsp;&emsp;如果需要跳过若干个元素，或者跳过一段时间，可以使用skip或者skipLast操作符。下面是跳过若干个元素的例子：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span><span class="s">&quot;b&quot;</span><span class="o">,</span><span class="s">&quot;c&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">skip</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">skipLast</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;假设需要跳过一段时间，可以使用重载方法：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">skip</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">skipLast</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<h2>ignoreElements</h2>
<p>&emsp;&emsp;如果你不关心发送的元素，只关心onComplete和onError事件，可以使用ignoreElements操作符，他会把当前被观察者转换成Completable类型的被观察者：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span><span class="s">&quot;b&quot;</span><span class="o">,</span><span class="s">&quot;c&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">ignoreElements</span><span class="o">()</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="s">&quot;complete&quot;</span><span class="o">));</span>
</pre></div>


<h2>distinct / distinctUntilChanged</h2>
<p>&emsp;&emsp;如果想过滤掉重复的元素，可以使用distinct操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="s">&quot;c&quot;</span><span class="o">,</span> <span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="s">&quot;c&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">distinct</span><span class="o">()</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码只会输出a、b、c三个元素。</p>
<p>&emsp;&emsp;如果只需要过滤连续重复的元素，则可以使用distinctUntilChanged操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">&quot;a&quot;</span><span class="o">,</span> <span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="s">&quot;c&quot;</span><span class="o">,</span> <span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="s">&quot;b&quot;</span><span class="o">,</span> <span class="s">&quot;c&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">distinctUntilChanged</span><span class="o">()</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码会输出a、b、c、b、c这几个元素。</p>
<h2>timeout</h2>
<p>&emsp;&emsp;如果需要过滤超时操作，可以使用timeout操作符：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">timeout</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码输出0后超时，抛出异常。</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">timeout</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">,</span>  <span class="n">Flowable</span><span class="o">.</span><span class="na">just</span><span class="o">(-</span><span class="mi">1L</span><span class="o">))</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码先输出0，然后超时，使用自定义的Flowable输出-1。</p>
<h2>throttleFirst</h2>
<p>&emsp;&emsp;如果你需要在一段时间内只响应第一次的操作，比如说一段时间内连续点击按钮只执行第一次的点击操作，throttleFirst操作符就可以满足这个需求，使用例子如下：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">throttleFirst</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span><span class="c1">//每1秒中只处理第一个元素</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述结果为0、2、4、6、8，其中1、3、5、7、9都被过滤了。</p>
<h2>throttleLast / sample</h2>
<p>&emsp;&emsp;除了throttleFirst，有对应的throttleLast操作符，它的功能和sample操作符相同，都是隔一段时间采集一个元素：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">throttleLast</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span><span class="c1">//每2秒中采集最后一个元素</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>

<span class="c1">//等价于</span>
<span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">sample</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span><span class="c1">//每2秒中采集最后一个元素</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述代码只会输出1、3、5、7，之后会直接触发onComplete事件。</p>
<h2>throttleWithTimeout / debounce</h2>
<p>&emsp;&emsp;假设有一种即时显示搜索结果需求，要求一段时间用户不输入才响应请求搜索结果，这样的需求可以使用throttleWithTimeout操作符或者debounce操作符，举个例子：</p>
<div class="highlight"><pre><span></span><span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">throttleWithTimeout</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span><span class="c1">//2秒内有新数据则抛弃旧数据</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
<span class="c1">//等价于</span>
<span class="n">Flowable</span><span class="o">.</span><span class="na">intervalRange</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span>
        <span class="o">.</span><span class="na">debounce</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">)</span><span class="c1">//2秒内有新数据则抛弃旧数据</span>
        <span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">ele</span> <span class="o">-&gt;</span> <span class="n">Log</span><span class="o">.</span><span class="na">i</span><span class="o">(</span><span class="s">&quot;tag&quot;</span><span class="o">,</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ele</span><span class="o">)));</span>
</pre></div>


<p>&emsp;&emsp;上述例子中只会输出9这个元素，因为没当接收到一个元素的时候，会等待2秒，如果有新的元素发送，则抛弃旧的元素，使用新的元素，直到2秒过去或者没有新的数据（比如onComplete）。</p>
<h2>尾声</h2>
<p>&emsp;&emsp;终于把过滤的操作符基本地说了一遍，其实每个操作符可能还有很多重载的形式，大家感兴趣的可以自己逐个试试，由于本人生活和工作上都越来越繁忙，所以以后的更新速度可能会放慢下来了。</p>
		
		<h2>相关文章</h2>
		<p style="margin-bottom: 5px;">
		&emsp;&emsp;RxJava 2.x 使用详解(一) 快速入门：
		<a href="https://maxwell-nc.github.io/android/rxjava2-1.html">https://maxwell-nc.github.io/android/rxjava2-1.html</a>
		</p>
		<p style="margin-bottom: 5px;">
		&emsp;&emsp;RxJava 2.x 使用详解(二) 创建操作符：
		<a href="https://maxwell-nc.github.io/android/rxjava2-2.html">https://maxwell-nc.github.io/android/rxjava2-2.html</a>
		</p>
		<p style="margin-bottom: 5px;">
		&emsp;&emsp;RxJava 2.x 使用详解(三) 过滤操作符：
		<a href="https://maxwell-nc.github.io/android/rxjava2-3.html">https://maxwell-nc.github.io/android/rxjava2-3.html</a>
		</p>
		<br/><br/>
		
		<blockquote style="/* color: #eb2344; */"><b style="font-weight: 100;">
		原创文章，欢迎转载，请保留出处。有任何错误、疑问或者建议，欢迎指出。<br/>
		请注明文章出自于：https://maxwell-nc.github.io/android/rxjava2-3.html
		</b></blockquote>
		<br/>
			<div style="display: inline;font-size: 13px;">
				上一篇：<a href="https://maxwell-nc.github.io/android/rxjava2-2.html">RxJava 2.x 使用详解(二) 创建操作符</a>
			</div>

    <div class="comments">
        <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'maxwell-nc';
                var disqus_identifier = 'android/rxjava2-3.html';
                //var disqus_url = 'https://maxwell-nc.github.io/android/rxjava2-3.html';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
        <noscript>Please enable JavaScript to view the comments.</noscript>
    </div>
        
    </div>
        <!-- /Content --> 

        <!-- Footer -->
        <div class="footer gradient-2">
            <div class="container footer-container ">
                <div class="row">
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">社交</div>
                        <ul class="list-unstyled">
                            <li><a href="https://github.com/maxwell-nc" target="_blank">Github</a></li>
                            <li><a href="mailto:maxwell_nc@163.com" target="_blank">Email</a></li>
                        </ul>
                    </div>
                    <div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                        <div class="footer-title">链接</div>
                        <ul class="list-unstyled">
                            <li><a href="http://blog.csdn.net/maxwell_nc" target="_blank">旧的博客</a></li>
                        </ul>
                    </div> 
					<div class="col-xs-4 col-sm-3 col-md-3 col-lg-3">
                    </div>
                    <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3" style="font-size: 12px;">
                        <p class="pull-right text-right">
                            <em>Proudly powered by <a href="http://docs.getpelican.com/" target="_blank"><u>Pelican</u></a></em><br/>
                            <em>Theme by <a href="https://github.com/molivier" target="_blank"><u>Molivier</u></a></em><br/>
                            <em>Modified Theme by <a href="https://github.com/maxwell-nc" target="_blank"><u>Maxwell-nc</u></a></em><br/>
                            <small>&copy; Maxwell-nc 2017</small>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Footer -->
    </body>
</html>